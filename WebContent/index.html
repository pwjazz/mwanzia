<!DOCTYPE html PUBLIC "-W3CDTD XHTML 1.0 TransitionalEN" "http:www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http:www.w3.org/1999/xhtml" xmlns:jjro="http://tbd/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JJRO Demo</title>
        <!-- Required JavaScript Libraries -->
        <script type="text/javascript" src="/js/console.js"></script>
        <script type="text/javascript">
        	// Clear the console
            console.clear();
        </script>
        <script type="text/javascript" src="/js/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="/js/json2.js"></script>
        <script type="text/javascript" src="/js/typesystem.js"></script>
        <script type="text/javascript" src="/js/date.format.js"></script>
        <script type="text/javascript" src="/js/jjro.core.js"></script>
        <!-- JPA Plugin -->
        <script type="text/javascript" src="/js/jjro.jpa.js"></script>
        <script type="text/javascript" src="/js/jjro.forms.js"></script>
        <!-- Optional JJRO UI library and dependencies -->
        <script type="text/javascript" src="/js/owl_util.js"></script>
        <script type="text/javascript" src="/js/jquery.mapAttributes.js"></script>
        <script type="text/javascript" src="/js/jjro.ui.js"></script>
        <!-- The dynamically created server.js -->
        <script type="text/javascript" src="/server.js"></script>
		<!-- BlockUI plugin for loading indicators -->
		<script type="text/javascript" src="/js/jquery.blockUI.js"></script>
		<!-- This page's javascript and css -->
        <script type="text/javascript" src="/js/index.js"></script>
        <link rel="stylesheet" href="/styles/index.css" type="text/css" media="screen" />
    </head>
    <body>
        <p>
            Demo&nbsp;&nbsp;<a href="core_tests.html">Core Tests</a>&nbsp;&nbsp;<a href="/perf_tests.html">Performance Tests</a>&nbsp;&nbsp;<a href="/tutorial.html">Tutorial</a>
        </p>
        <h1>JJRO Demo</h1>
        <p>
            This is a demo of JJRO, using a sample Application that allows you to manage a set of companies, their branches and their customers.
        </p>
        <p>
            Databinding is implemented using the jjro.ui.js jQuery plugin.
        </p>
        <div id="companiesContainer">
            <h3>Companies</h3>
			<!-- List of Companies.  Note the onchange handler. -->
			<select id="companies" multiple size="10" onchange="getCurrentCompany().showBranches()">
            	<!-- The jjro:set attribute indicates what value to bind into the body of the option tag. -->
				<!-- Notice the implicit bound variable, which refers to the object that is data bound to this tag. In this case, it is a Company. -->
				<!-- Prefixing a regular attribute like "value" with "jjro:" allows you to use javascript expressions to populate the attribute. -->
                <option jjro:value="bound.id" jjro:set="bound.name"></option>
            </select>
        </div>
        <div id="branchesContainer">
            <h3>Branches</h3>
			<!-- List of Branches.  Note the onchange handler. -->
            <select id="branches" multiple size="10" onchange="getCurrentBranch().showAccounts()">
                <option jjro:value="bound.value.id" jjro:set="bound.value.name + ' (' + bound.value.manager.fullName() + ')'"></option>
            </select>
        </div>
        <div id="accountsContainer" style="display: none;">
		    <div id="accountsView">
				<!-- The link will open in a fancybox lightbox because it's been marked with class 'fancybox'. -->
				<!-- Notice the onclick handler that makes sure the new account form is bound every time the link is clicked. -->
				<!-- This ensures that the form is cleared and ready to go every time. -->
	            <h3>Accounts <a href="javascript:void(0);" style="font-size: 12px;" onclick="getCurrentBranch().showNewAccountForm()">(+) add account</a></h3>
				<!-- Table of accounts -->
	            <table id="accounts" cellspacing="0" cellpadding="5">
	                <thead>
	                    <tr><th>Number</th><th>Owner</th><th>Date Opened</th><th>Balance</th></tr>
	                </thead>
	                <tbody>
	                    <tr>
	                    	<td jjro:set="bound.number"></td>
							<td jjro:set="bound.owner.fullName()"></td>
							<td jjro:set="bound.dateOpened.format('mm/dd/yyyy')"></td>
	                        <td jjro:set="bound.balance"></td>
	                    </tr>
	                </tbody>
	            </table>
            </div>
			<div id="newAccountFormView" style="display: none;">
                <!-- This sets up our form.  Notice that neither action nor method are specified. -->
                <!-- This form will be bound to a remote method when someone clicks the "add account" link, so no action is required. -->
                <!-- Notice how we use jjro:messages to specify a map of messages to use during validation (see index.js for definition of newAccountFormMessages) -->
                <!-- Notice the special event jjro:onsubmitted.  This event is triggered after the form is successfully submitted. -->
                <!-- We use jjro:onsubmitted to call accountAdded, which will add the Account to the list of accounts and close our form. -->
                <form id="newAccountForm" jjro:messages="newAccountFormMessages" jjro:onsubmitted="accountAdded(result)">
                    <h2>Add an Account</h2>
                    <div class="formField newline">
                        First Name
                        <br/>
                        <input type="text" name="owner.firstName" tabindex="1" />
                    </div>
                    <div class="formField">
                        Last Name
                        <br/>
                        <input type="text" name="owner.lastName" tabindex="2" />
                    </div>
                    <div class="formField newline">
                        Age
                        <br/>
                        <input type="text" name="owner.age" maxlength="2" size="2" tabindex="3" />
                    </div>
                    <div class="formField newline">
                        Street Address Line 1
                        <br/>
                        <input type="text" name="owner.address.line1" tabindex="4" />
                    </div>
                    <div class="formField">
                        Street Address Line 2
                        <br/>
                        <input type="text" name="owner.address.line2" tabindex="5" />
                    </div>
                    <div class="formField newline">
                        City
                        <br/>
                        <input type="text" name="owner.address.city" tabindex="6" />
                    </div>
                    <div class="formField">
                        State
                        <br/>
                        <select name="owner.address.state" jjro:list="TestApplication.states" tabindex="7" >
                            <option jjro:value="bound" jjro:set="bound"></option>
                        </select>
                    </div>
                    <div class="formField newline">
                        Zip
                        <br/>
                        <input type="text" name="owner.address.postalCode" tabindex="8" />
                    </div>
                    <div class="formField">
                        <!-- Notice the use of a regular submit button. -->
                        <!-- JJRO form validation and submission hook into the regular onsubmit event, -->
                        <!-- so they can be triggered from submit buttons or simply pressing enter in a form field, -->
                        <!-- per the browser's standard behavior. -->
                        <input type="submit" value="Submit" tabindex="9" />
                    </div>
                    <div class="clear"></div>
                </form>
            </div>
		</div>
    </body>
</html>
